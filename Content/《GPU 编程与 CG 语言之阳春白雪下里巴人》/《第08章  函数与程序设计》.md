## 第08章  函数与程序设计

> 知识本身没有告诉人怎样运用它，运用的方法乃在书本之外。这是一门技艺，不经实验就不能学到。<br>
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　      ------ 培根


　　通过第 5 章到第 7章的阅读，我们已经知道了怎么声明变量（第 5 章），怎么写表达式和语句（第 6 章），怎么将输入\输出参数绑定到语义词（第 7 章），本章将首先描述 Cg 语言中函数的写法，以及函数是否可以重载；然后阐述顶点\片段着色程序中入口函数的概念（类似 C\C++ 中的 main() 函数）；最后，以 Cg 标准函数库来结束本章。

### 8.1 函数

　　函数可以被看做一个由用户定义的操作。Cg 语言中的函数声明形式与 C\C++ 中相同，由返回类型（return type）、函数名、形参列表（parameter list, 位于括号中，并用逗号分隔的参数表）和函数体组成。函数体包含在花括号中。如果没有返回值，则函数的返回类型是 void。下面是函数定义的例子：

 ```
　　void myFunc(inout float val) 
　　{
　　　　.........
　　　　val += 10.0;
　　}

　　float myFunc(float vals[]) 
　　{
　　　　float sum = 0.0;
　　　　.........
　　　　return sum;
　　}
 ```

　　注意：如果函数没有返回值，函数的返回类型一定要是 void，否则编译会出现错误，错误的信息大概形式是：

 ```
　　error C0000:syntax error, unexpected')'at token '('
　　error C0501:type name expected at token '('
　　error C1110:function 'main_v' has no return statement 
 ```

　　参数传递机制是函数概念中的重中之重，请参阅 7.4 节“输入\输出修饰符”中的论述。此外，有一个比较特殊的函数形参类型，不论在 C\C++ 中还是在 Cg 语言中，都是一个令人头痛的话题，它就是数组形参。

#### 8.1.1 数组形参

　　在 C/C++ 中，当一个数组作为函数的形参是，实际上传入的只是指向首元素的指针，并且数组边界被忽略（参阅 stephen C. Dewhurst 所著的《C++ 必知必会》）。而在 Cg 语言中不存在指针机制（图形硬件不支持），数组作为函数形参，传递的是数组的完整拷贝。关于 Cg 中形参数组的原始资料可以在文献【3】 Array 章节中查到：
<br><br>
　　“The most important difference from C is that arrays are first-class types. That means array assignments actually copy the entire array, and arrays that are passed as parameters are passed by value, rather than by reference”.
<br><br>
　　这段英文中描述道，Cg 语言中数组是“first-class types”，中文翻译为“第一类数据类型”，所谓“第一类（first-class）”的含义是，强调该类型数据是“不可分解的、最高级别的、不被重述的”，即“第一类数据类型”和“基础数据类型”的概念是近同的、如有兴趣深入了解“first-class”概念，可参阅 Matthieu Sozeau and Nicolas Oury 所著的 “First-Class Type Classes” 一文。
<br><br>
　　数组类型变量作为函数形参，可以是一维的也可以是多维的，并且不必声明数组长度，即 Unsized Array。例如：

 ```
　　float myFunc(float vals[])
　　{
　　　　float sum = 0.0;
　　　　for(int i = 0; i < vals.length; i++)
　　　　{
　　　　　　sum += vals[i];
　　　　}

　　　　return sum;
　　}
 ```

### 8.2 函数重载

<br><br>
<br><br>

### 8.3 入口函数

<br><br>
<br><br>

### 8.4 CG 标准函数库

#### 8.4.1 数学函数（Mathematical Functions）

<br><br>
<br><br>

#### 8.4.2 几何函数（Geometric Functions）

<br><br>
<br><br>

#### 8.4.3 纹理映射函数（Texture Map Functions）

<br><br>
<br><br>

#### 8.4.4 偏导函数（Derivative Functions）

<br><br>
<br><br>

#### 8.4.5 调试函数（Debugging Functions）

<br><br>
<br><br>

### 8.5 在未来将被解决的问题

<br><br>
<br><br>

### 开篇语：

<br><br>
<br><br>
